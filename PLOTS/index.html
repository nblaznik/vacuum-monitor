<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Pressure Plots (BEC Lab)</title>
  <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono&display=swap" rel="stylesheet">
  <style>
    body {
      font-family: 'JetBrains Mono', monospace;
      background-color: #f8f9fa;
      text-align: center;
      padding: 30px;
    }

    h1 {
      color: #415a77;
    }

    #plot-main, #plot-vals {
      border: none;
    }

    .btn-group {
      margin: 10px 0;
      display: flex;
      justify-content: center;
      flex-wrap: wrap;
      gap: 10px;
    }

    .btn, .toggle-btn {
      background-color: #778da9;
      color: white;
      border: none;
      padding: 10px 20px;
      cursor: pointer;
      font-size: 16px;
      border-radius: 6px;
      transition: background-color 0.3s ease, box-shadow 0.1s ease;
    }

    .btn:hover, .toggle-btn:hover {
      background-color: #415a77;
    }

    .toggle-btn.active {
      background-color: #1b263b;
      box-shadow: inset 0 0 5px #00000088;
    }
  </style>
</head>
<body>

  <h1>Live Pressure Monitor (BEC Lab)</h1>

  <!-- Time Window Selection -->
  <div class="btn-group" id="time-buttons">
    <button class="btn" onclick="setTimeWindow('minute')">Last Minute</button>
    <button class="btn" onclick="setTimeWindow('hour')">Last Hour</button>
    <button class="btn" onclick="setTimeWindow('5_hour')">Last 5 Hours</button>
    <button class="btn" onclick="setTimeWindow('day')">Last Day</button>
    <button class="btn" onclick="setTimeWindow('week')">Last Week</button>
    <button class="btn" onclick="setTimeWindow('month')">Last Month</button>
    <button class="btn" onclick="setTimeWindow('all')">All Time</button>
  </div>

  <!-- Channel Toggle Buttons -->
  <div class="btn-group" id="channel-buttons">
    <button class="toggle-btn active" onclick="toggleChannel(0)">All</button>
    <button class="toggle-btn" onclick="toggleChannel(1)">Ch 1</button>
    <button class="toggle-btn" onclick="toggleChannel(2)">Ch 2</button>
    <button class="toggle-btn" onclick="toggleChannel(3)">Ch 3</button>
    <button class="toggle-btn" onclick="toggleChannel(4)">Ch 4</button>
    <button class="toggle-btn" onclick="toggleChannel(5)">Ch 5</button>
    <button class="toggle-btn" onclick="toggleChannel(6)">Ch 6</button>
    <button class="toggle-btn" onclick="toggleChannel(7)">Diagram</button>
  </div>

  <div style="display: flex; justify-content: center; gap: 20px; flex-wrap: wrap;">
    <img id="plot-main" src="plot_hour.png" alt="Pressure Plot" style="max-width: 48%; height: auto;">
    <img id="plot-vals" src="plot_vals.png" alt="Pressure Values" style="max-width: 28%; height: 100%;">
  </div> 

  <script>
    let currentWindow = '5_hour';
    let selectedChannels = new Set([0]); // 0 = all, others = 1â€“6

    function setTimeWindow(range) {
      currentWindow = range;
      updatePlot();
    }

  function toggleChannel(ch) {
    const buttons = document.querySelectorAll("#channel-buttons .toggle-btn");
    selectedChannels.clear();
    selectedChannels.add(ch);

    buttons.forEach((btn, idx) => {
      if (idx === ch) {
        btn.classList.add("active");
      } else {
        btn.classList.remove("active");
      }
    });

    updatePlot();
  }

  function updatePlot() {
    const timestamp = new Date().getTime();
    const img = document.getElementById("plot-main");
    const img2 = document.getElementById("plot-vals");

    const ch = Array.from(selectedChannels)[0];

    if (ch === 0) {
      // "All" selected
      img.src = `plot_${currentWindow}.png?t=${timestamp}`;
    } else if (ch >= 1 && ch <= 6) {
      // Specific pressure channel
      img.src = `plot_ch${ch}_${currentWindow}.png?t=${timestamp}`;
    } else if (ch === 7) {
      // "Diagram" button: load separate image
      img.src = `diagram.png?t=${timestamp}`;
    } else {
      // Fallback
      img.src = "";
      img.alt = "Unsupported selection.";
    }

    img2.src = `plot_vals.png?t=${timestamp}`;
  }
  </script>

</body>
</html>
